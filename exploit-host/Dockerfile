FROM docker.io/openjdk:8u181-jdk-alpine AS build

WORKDIR /app

RUN apk --no-cache add maven

COPY pom.xml dependency-reduced-pom.xml ./

RUN mvn clean dependency:list install

COPY src src

RUN mvn package -q

FROM docker.io/openjdk:8u181-jre-alpine

WORKDIR /app

COPY --from=build /app/target/exploit-host-1.0-SNAPSHOT.jar ./exploit-host.jar

CMD ["java", "-cp", "./exploit-host.jar", "App"]
